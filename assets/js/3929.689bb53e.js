(window.webpackJsonp=window.webpackJsonp||[]).push([[3929],{4558:function(s,a,e){"use strict";e.r(a);var t=e(15),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),e("p",[s._v("Apache Doris是当下非常火热和流行的MPP架构OLAP数据库，很多同学想自学/测试Doris的使用和能力，但是又苦于没有环境或者畏惧冗长的编译+搭建过程，整个过程极大的劝退了很多有些尝试意愿、但又由于各种客观因素无法承担过高学习成本导致尝试失败的同学，故此Apache Doris社区三位社区同学苏奕嘉、种益、杨春东制作了三个不同设计的版本安装方式并提供下载，以此降低大家的学习门槛和提升学习/测试效率。")]),s._v(" "),e("p",[e("strong",[s._v("重要说明：该教程提供的编译方式及运行环境都以单节点部署伪集群为目标，故性能会【大打折扣】，如想体验完整Apache Doris数据库的能力，请以完整集群部署，单节点伪集群【仅适用于学习、功能测试】所用！")])]),s._v(" "),e("h2",{attrs:{id:"版本说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#版本说明"}},[s._v("#")]),s._v(" 版本说明")]),s._v(" "),e("h3",{attrs:{id:"_1-极速体验版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-极速体验版"}},[s._v("#")]),s._v(" 1. 极速体验版")]),s._v(" "),e("h4",{attrs:{id:"_1-1-优点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-优点"}},[s._v("#")]),s._v(" 1.1. 优点")]),s._v(" "),e("ol",[e("li",[s._v("超快速的部署体验（网速OK的话十五分钟内部署完毕）")]),s._v(" "),e("li",[s._v("单节点部署")]),s._v(" "),e("li",[s._v("支持多环境运行：虚拟机/云服务器/支持Docker的物理机（Mac/Win/Linux）")])]),s._v(" "),e("h4",{attrs:{id:"_1-2-缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-缺点"}},[s._v("#")]),s._v(" 1.2. 缺点")]),s._v(" "),e("ol",[e("li",[s._v("数据存储是在Docker容器中，如容器如损坏，会导致数据丢失")]),s._v(" "),e("li",[s._v("若非干净纯净的系统环境，可能需要手动执行部分BE注册FE的命令")])]),s._v(" "),e("h4",{attrs:{id:"_1-3-适用人群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-适用人群"}},[s._v("#")]),s._v(" 1.3. 适用人群")]),s._v(" "),e("p",[s._v("学生、培训机构、体验/测试人员")]),s._v(" "),e("h4",{attrs:{id:"_1-4-安装建议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-安装建议"}},[s._v("#")]),s._v(" 1.4. 安装建议")]),s._v(" "),e("p",[s._v("系统为纯净新系统最佳，无需任何修改即可开箱即用")]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"_2-完全部署版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-完全部署版"}},[s._v("#")]),s._v(" 2. 完全部署版")]),s._v(" "),e("h4",{attrs:{id:"_2-1-优点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-优点"}},[s._v("#")]),s._v(" 2.1. 优点")]),s._v(" "),e("ol",[e("li",[s._v("完整的环境部署（MySQL-Client等组件）")]),s._v(" "),e("li",[s._v("自由的部署安排（有众多可选安装参数）")]),s._v(" "),e("li",[s._v("无惧Docker容器损坏（最小降低损失，可极速恢复）")]),s._v(" "),e("li",[s._v("单节点部署")]),s._v(" "),e("li",[s._v("支持多环境运行：虚拟机/云服务器，暂未适配物理机（后续升级版本会支持）")])]),s._v(" "),e("h4",{attrs:{id:"_2-2-缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-缺点"}},[s._v("#")]),s._v(" 2.2. 缺点")]),s._v(" "),e("ol",[e("li",[s._v("安装过程时间较长（视网速和机器性能而定）")]),s._v(" "),e("li",[s._v("安装步骤多，代表可能故障率较高")])]),s._v(" "),e("h4",{attrs:{id:"_2-3-适用人群"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-适用人群"}},[s._v("#")]),s._v(" 2.3. 适用人群")]),s._v(" "),e("p",[s._v("学生、培训机构、体验/测试人员中的持续性教学受众（数据不易丢失）")]),s._v(" "),e("h4",{attrs:{id:"_2-4-安装建议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-安装建议"}},[s._v("#")]),s._v(" 2.4. 安装建议")]),s._v(" "),e("p",[s._v("该版本建议完完全全的纯净新系统，以此降低安装故障率")]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"_3-存算分离版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-存算分离版"}},[s._v("#")]),s._v(" 3. 存算分离版")]),s._v(" "),e("p",[s._v("该版本还在制作过程中，教程及相关文档后续推出，可视为完全部署版的Plus版本。")]),s._v(" "),e("hr"),s._v(" "),e("h2",{attrs:{id:"目的"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目的"}},[s._v("#")]),s._v(" 目的")]),s._v(" "),e("p",[s._v("该教程最后成果模块提供了"),e("code",[s._v("各个版本")]),s._v("下载地址，只需在服务器拉取"),e("code",[s._v("不同版本shell脚本")]),s._v("运行即可，在"),e("code",[s._v("/opt/docker/doris/sbin")]),s._v("目录下会有"),e("code",[s._v("start_doris_docker.sh")]),s._v("和"),e("code",[s._v("stop_doris_docker.sh")]),s._v("脚本支持一键启停，同时会在一键部署的过程中将两个脚本添加至环境变量，最大程度简化单节点测试部署和启停操作。")]),s._v(" "),e("p",[e("strong",[s._v("步骤过程可以忽略")]),s._v("，除非有定制化的一键部署Docker集群的镜像集群制作需求，大可不必照着教程再来一遍，官方已提供了下载地址，无需重复劳动。")]),s._v(" "),e("h2",{attrs:{id:"环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#环境"}},[s._v("#")]),s._v(" 环境")]),s._v(" "),e("ul",[e("li",[s._v("服务器：腾讯云 2C 4G 6M 一台")]),s._v(" "),e("li",[s._v("OS：CentOS 7.6")]),s._v(" "),e("li",[s._v("Docker-V：20.10.12")]),s._v(" "),e("li",[s._v("Doris-V：0.15")]),s._v(" "),e("li",[s._v("MySQL-Client-V：5.7")]),s._v(" "),e("li",[s._v("FE-Num：1")]),s._v(" "),e("li",[s._v("BE-Num：3")])]),s._v(" "),e("h2",{attrs:{id:"步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),e("h3",{attrs:{id:"_1-安装docker环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装docker环境"}},[s._v("#")]),s._v(" 1. 安装Docker环境")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("Docker 要求 CentOS 系统的内核版本高于"),e("code",[s._v("3.10")]),s._v(" ，首先查看系统内核版本是否满足")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -r\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("使用 "),e("code",[s._v("root")]),s._v(" 权限登录系统，确保 yum 包更新到最新")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum update -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("假如安装过旧版本，先卸载旧版本")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("  docker-common docker-selinux docker-engine\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("设置yum源（加速yum下载速度）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("查看所有仓库中所有docker版本，并选择特定版本安装，一般可直接安装最新版")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("yum list docker-ce --showduplicates "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -r\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装docker")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("安装最新稳定版本")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce -y  "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装的是最新稳定版本，因为repo中默认只开启stable仓库")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装指定版本")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("FQPN"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -y\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 例如：")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-20.10.11.ce -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])])]),s._v(" "),e("li",[e("p",[s._v("启动并加入开机启动")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#加入开机自启动")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("查看Version，验证是否安装成功")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("若出现Client和Server两部分内容，则证明安装成功")])])]),s._v(" "),e("h3",{attrs:{id:"_2-容器创建及测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-容器创建及测试"}},[s._v("#")]),s._v(" 2. 容器创建及测试")]),s._v(" "),e("p",[e("strong",[s._v("在创建之前，请准备好已完成编译的FE/BE文件，此教程不再赘述编译过程。")])]),s._v(" "),e("ol",[e("li",[e("p",[s._v("拉取Doris编译镜像做测试")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull apache/incubator-doris:build-env-ldb-toolchain-latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建Doris-Docker的文件（包括元数据文件夹）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/docker/doris\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("将编译好的FE和BE拷贝至Docker文件群内")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r 编译好的Doris根目录/fe/ /opt/docker/doris/\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r 编译好的Doris根目录/be/ /opt/docker/doris/be-01\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r 编译好的Doris根目录/be/ /opt/docker/doris/be-02\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r 编译好的Doris根目录/be/ /opt/docker/doris/be-03\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动FE-Docker")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8030")]),s._v(":8030 -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9030")]),s._v(":9030 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-fe -v /opt/docker/doris/fe:/opt/doris/fe -v /opt/docker/doris/doris-meta:/opt/doris/doris-meta apache/incubator-doris:build-env-ldb-toolchain-latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("进入FE-Docker以及安装组件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入fe-docker")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -ti doris-fe /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装net-tools用于查看IP")]),s._v("\nyum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("修改FE配置")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看fe-docker的IPv4地址")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改配置文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /opt/doris/fe/conf/fe.conf\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消priority_networks的注解，并根据Docker的网段进行配置")]),s._v("\npriority_networks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.0/16 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这里要根据你Docker的IP确定")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("切换Docker-JDK版本")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换Java版本为JDK1.8，该镜像默认为JDK11")]),s._v("\nalternatives --set java java-1.8.0-openjdk.x86_64\nalternatives --set javac java-1.8.0-openjdk.x86_64\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib/jvm/java-1.8.0\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 校验是否切换版本成功")]),s._v("\njava -version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("配置FE-Docker的环境变量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置环境变量")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile.d/doris.sh\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DORIS_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/doris/fe/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DORIS_HOME")]),s._v("/bin\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存并source")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile.d/doris.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动Doris-FE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("start_fe.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("检查FE是否启动成功")]),s._v(" "),e("blockquote",[e("ol",[e("li",[e("p",[s._v("检查是否启动成功,JPS命令下有没有PaloFe进程")])]),s._v(" "),e("li",[e("p",[s._v("FE 进程启动后，会首先加载元数据，根据 FE 角色的不同，在日志中会看到 "),e("code",[s._v("transfer from UNKNOWN to MASTER/FOLLOWER/OBSERVER")]),s._v("。最终会看到 "),e("code",[s._v("thrift server started")]),s._v(" 日志，并且可以通过 mysql 客户端连接到 FE，则表示 FE 启动成功。")])]),s._v(" "),e("li",[e("p",[s._v("也可以通过如下连接查看是否启动成功：\n"),e("code",[s._v("http://fe_host:fe_http_port/api/bootstrap")])]),s._v(" "),e("p",[s._v("如果返回：\n"),e("code",[s._v('{"status":"OK","msg":"Success"}')])]),s._v(" "),e("p",[s._v("则表示启动成功，其余情况，则可能存在问题。")])]),s._v(" "),e("li",[e("p",[s._v("外网环境访问"),e("code",[s._v("http://fe_host:fe_http_port")]),s._v(" 查看是否可以访问WebUI界面，登录账号默认为root，密码为空")])])]),s._v(" "),e("p",[s._v("注：如果在 fe.log 中查看不到启动失败的信息，也许在 fe.out 中可以看到。")])])]),s._v(" "),e("li",[e("p",[s._v("宿主机安装MySQL客户端")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.37-1.el7.x86_64.rpm-bundle.tar\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -xvf mysql-5.7.37-1.el7.x86_64.rpm-bundle.tar\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-common-5.7.37-1.el7.x86_64.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-libs-5.7.37-1.el7.x86_64.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-client-5.7.37-1.el7.x86_64.rpm\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("连接FE并修改密码")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mysql -h FE-Docer的IP -P "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9030")]),s._v(" -uroot\nSET PASSWORD FOR "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PASSWORD"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'your_password'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 也可以创建新用户")]),s._v("\nCREATE "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),s._v(" IDENTIFIED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test_passwd'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("后续链接时需要使用如下格式")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mysql -h FE_HOST -P9030 -uusername -ppassword\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("添加BE节点注册信息")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("ALTER SYSTEM ADD BACKEND "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host:port"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其中 host 为 BE 所在节点 ip；port 为 be/conf/be.conf 中的 heartbeat_service_port，默认9050。")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动BE-Docker")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9061")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-01 -v /opt/docker/doris/be-01:/opt/doris/be apache/incubator-doris:build-env-ldb-toolchain-latest\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9062")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-02 -v /opt/docker/doris/be-02:/opt/doris/be apache/incubator-doris:build-env-ldb-toolchain-latest\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9063")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-03 -v /opt/docker/doris/be-03:/opt/doris/be apache/incubator-doris:build-env-ldb-toolchain-latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("进入BE-Docker以及安装组件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入fe-docker,以01为例")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -ti doris-be-01 /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装net-tools用于查看IP")]),s._v("\nyum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("修改BE配置")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看fe-docker的IPv4地址")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改配置文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /opt/doris/be/conf/be.conf\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消priority_networks的注解，并根据Docker的网段进行配置")]),s._v("\npriority_networks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.0/16 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这里要根据你Docker的IP确定")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("配置BE-Docker的环境变量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置环境变量")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile.d/doris.sh\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DORIS_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/doris/be/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DORIS_HOME")]),s._v("/bin\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存并source")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile.d/doris.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动Doris-BE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("start_be.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("检查BE是否启动成功")]),s._v(" "),e("blockquote",[e("ol",[e("li",[e("p",[s._v("BE 进程启动后，如果之前有数据，则可能有数分钟不等的数据索引加载时间。")])]),s._v(" "),e("li",[e("p",[s._v("如果是 BE 的第一次启动，或者该 BE 尚未加入任何集群，则 BE 日志会定期滚动 "),e("code",[s._v("waiting to receive first heartbeat from frontend")]),s._v(" 字样。表示 BE 还未通过 FE 的心跳收到 Master 的地址，正在被动等待。这种错误日志，在 FE 中 ADD BACKEND 并发送心跳后，就会消失。如果在接到心跳后，又重复出现 "),e("code",[s._v("master client, get client from cache failed.host: , port: 0, code: 7")]),s._v(" 字样，说明 FE 成功连接了 BE，但 BE 无法主动连接 FE。可能需要检查 BE 到 FE 的 rpc_port 的连通性。")])]),s._v(" "),e("li",[e("p",[s._v("如果 BE 已经被加入集群，日志中应该每隔 5 秒滚动来自 FE 的心跳日志："),e("code",[s._v("get heartbeat, host: xx.xx.xx.xx, port: 9020, cluster id: xxxxxx")]),s._v("，表示心跳正常。")])]),s._v(" "),e("li",[e("p",[s._v("其次，日志中应该每隔 10 秒滚动 "),e("code",[s._v("finish report task success. return code: 0")]),s._v(" 的字样，表示 BE 向 FE 的通信正常。")])]),s._v(" "),e("li",[e("p",[s._v("同时，如果有数据查询，应该能看到不停滚动的日志，并且有 "),e("code",[s._v("execute time is xxx")]),s._v(" 日志，表示 BE 启动成功，并且查询正常。")])]),s._v(" "),e("li",[e("p",[s._v("也可以通过如下连接查看是否启动成功：\n"),e("code",[s._v("http://be_host:be_http_port/api/health")])]),s._v(" "),e("p",[s._v("如果返回：\n"),e("code",[s._v('{"status": "OK","msg": "To Be Added"}')])]),s._v(" "),e("p",[s._v("则表示启动成功，其余情况，则可能存在问题。")]),s._v(" "),e("p",[s._v("注：如果在 be.INFO 中查看不到启动失败的信息，也许在 be.out 中可以看到。")])])])])]),s._v(" "),e("li",[e("p",[s._v("测试连通性")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录FE-MySQL")]),s._v("\nmysql -h FE_HOST -P9030 -uusername -ppassword\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行命令查看BE运行情况。如一切正常，isAlive 列应为 true。")]),s._v("\nSHOW PROC "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/backends'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("若连通性测试成功，则循环完成其他BE节点的部署即可")])])]),s._v(" "),e("h3",{attrs:{id:"_3-安装etcd环境-若多节点dokcer需配置-单节点可忽略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装etcd环境-若多节点dokcer需配置-单节点可忽略"}},[s._v("#")]),s._v(" 3. 安装ETCD环境（若多节点Dokcer需配置|单节点可忽略）")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("配置Hosts文件映射")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/hosts\n你本机内网IP地址 master\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装ETCD")]),s._v(" "),e("div",{staticClass:"language-SHELL line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装ETCD")]),s._v("\nyum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y etcd\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启ETCD")]),s._v("\nsystemctl restart etcd\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("设置开机启动")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" etcd\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("修改ETCD配置")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先查找本机的IP地址")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份原始配置文件")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/etcd/etcd.conf /etc/etcd/etcd.conf.bak\n "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编辑ETCD的conf文件")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/etcd/etcd.conf\n "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改监听客户端地址为")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ETCD_LISTEN_CLIENT_URLS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://master:2379,http://127.0.0.1:2379,http://master:4001,http://127.0.0.1:4001"')]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改通知客户端地址为")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ETCD_ADVERTISE_CLIENT_URLS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://master:2379,http://master:4001"')]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存退出")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("设置ETCD网段")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Flannel使用Etcd进行配置，来保证多个Flannel实例之间的配置一致性，所以需要在etcd上进行如下配置（'/atomic.io/network/config'这个key与上文/etc/sysconfig/flannel中的配置项FLANNEL_ETCD_PREFIX是相对应的，错误的话启动就会出错）")]),s._v("\netcdctl mk /atomic.io/network/config "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"Network":"172.20.0.0/16","SubnetMin":"172.20.1.0","SubnetMax":"172.20.254.0"}\'')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("重启ETCD")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl restart etcd \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("测试")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看ETCD进程是否存在")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" etcd\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看端口使用情况，因为ETCD默认TCP:2379端口通讯")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("lsof")]),s._v(" -i:2379\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用get命令查看是否设置成功")]),s._v("\netcdctl get /atomic.io/network/config \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 若出现以下信息，则代表设置成功")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Network"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.20.0.0/16"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SubnetMin"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.20.1.0"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SubnetMax"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.20.254.0"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看cluster-health")]),s._v("\netcdctl -C http://master:4001 cluster-health\netcdctl -C http://master:2379 cluster-health\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 若出现如下信息，则代表成功")]),s._v("\nmember 8e9e05c52164694d is healthy: got healthy result from http://你IP地址:2379（和4001）\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_4-安装flannel环境-若多节点dokcer需配置-单节点可忽略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装flannel环境-若多节点dokcer需配置-单节点可忽略"}},[s._v("#")]),s._v(" 4. 安装Flannel环境（若多节点Dokcer需配置|单节点可忽略）")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("Yum安装Flannel")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y flannel\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("配置Flannel")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备份原始配置文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /etc/sysconfig/flanneld /etc/sysconfig/flanneld.bak\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编辑配置文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sysconfig/flanneld\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改以下配置项")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FLANNEL_ETCD_ENDPOINTS")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://master:2379"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("设置开机自启")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" flanneld.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动Flannel")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl start flanneld.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("重启Docker")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("systemctl restart "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("测试")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看Flannel进程")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" flannel\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("h3",{attrs:{id:"_5-测试及远程连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-测试及远程连接"}},[s._v("#")]),s._v(" 5. 测试及远程连接")]),s._v(" "),e("p",[s._v("可使用Navicat等远端工具连接FE，地址为部署了FE服务的单机外网IP，端口为9030，如图所示")]),s._v(" "),e("img",{attrs:{src:s.$withBase("/images/blogs/doris-docker-cluster-install/2022-03-03-123903.png"),alt:""}}),s._v(" "),e("h3",{attrs:{id:"_6-shell脚本设计及开发"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-shell脚本设计及开发"}},[s._v("#")]),s._v(" 6. SHELL脚本设计及开发")]),s._v(" "),e("h4",{attrs:{id:"_6-1-完整部署版整体设计示意图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-完整部署版整体设计示意图"}},[s._v("#")]),s._v(" 6.1. 完整部署版整体设计示意图")]),s._v(" "),e("img",{attrs:{src:s.$withBase("/images/blogs/doris-docker-cluster-install/2022-03-04-041009/png"),alt:""}}),s._v(" "),e("h4",{attrs:{id:"_6-2-思路梳理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-思路梳理"}},[s._v("#")]),s._v(" 6.2. 思路梳理")]),s._v(" "),e("h5",{attrs:{id:"_6-2-1-极速体验版-极速体验免除安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-1-极速体验版-极速体验免除安装"}},[s._v("#")]),s._v(" 6.2.1 极速体验版（极速体验免除安装）")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("默认1FE 3BE安装")])]),s._v(" "),e("li",[e("p",[s._v("Docker安装（可参照"),e("strong",[s._v("步骤1")]),s._v("）")])]),s._v(" "),e("li",[e("p",[s._v("拉取Docker镜像群")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull freeoneplus/doris-fe:1.0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull freeoneplus/doris-be:1.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建FE-Docker容器")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8030")]),s._v(":8030 -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9030")]),s._v(":9030 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-fe freeoneplus/doris-fe:1.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("进入FE-Docker并获取IPv4地址")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it doris-fe /bin/bash\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-fe /bin/bash /opt/doris/fe/start_fe.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("循环创建BE-Docker容器并启动BE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9061")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-01 freeoneplus/doris-be:1.0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-be-01 /bin/bash /opt/doris/be/start_be.sh --daemon\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9062")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-02 freeoneplus/doris-be:1.0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-be-02 /bin/bash /opt/doris/be/start_be.sh --daemon\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9063")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-03 freeoneplus/doris-be:1.0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-be-03 /bin/bash /opt/doris/be/start_be.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("提示用户进行BE注册")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("亲爱的用户，欢迎使用 Apache Doris-极简版-Docker集群！\n接下来的文字请认真阅读：\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". 此版本集群为极简版单节点docker集群，所有数据均挂载在Docker集群内，请谨慎修改或删除容器！\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". 此版本预制注册三个BE节点至FE，但可能由于不同环境影响，预先注册的IP地址可能会出现错误，所以请仔细观察FE的预制IP地址："),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${FE-IP地址}")]),s._v("，若以上地址为172.17.0.2，则无需做任何修改即可直接使用，如果是其他数值，则需要进行链接FE进行BE注册\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". 您可以使用任意MySQL-Client或者MySQL工具连接FE-MySQL-Server\n若宿主机（您的虚拟机/云服务器）有MySQL-Client，则需要执行以下命令链接FE-MySQL-Server\nmysql -h "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${FE-IP地址}")]),s._v(" -P "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9030")]),s._v(" -uroot -p123456\n若您使用外网机器链接FE-MySQL-Server，则需要填入以下参数，您需要提前打开9030外网端口\nurl：您的服务器外网IP（虚拟机则视网络桥接方式）\nport：9030\nusername：root\npassword：123456\n然后执行以下命令清除已注册至FE的BE节点信息\n\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("以下需要逻辑处理"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n预设的三个BE地址为"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3,172.17.0.4,172.17.0.5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n该地址应为FE-IP地址最后一位自增3，所以如果预设错误，需要给出删除语句和增添语句\n比如FE-IP为 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.4，则需要给出删除"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3,172.17.0.4"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("两个BE节点的语句\nALTER SYSTEM DECOMMISSION BACKEND "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${FE-IP地址}")]),s._v(':9050"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n然后再给出新增的两个节点的IP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.6,172.17.0.7"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("注册语句\nALTER SYSTEM ADD BACKEND "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${FE-IP地址}")]),s._v(':9050"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("以上需要逻辑处理"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n感谢您的安装和使用Apache Doris！\n感谢您为开源世界作出的一份贡献！\n如有问题请打开地址：doris.freeoneplus.com\n扫描二维码添加Apache Doris社区微信群获取答疑~\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])])])]),s._v(" "),e("h5",{attrs:{id:"_6-2-2-完整部署版-数据落盘无惧丢失"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-2-完整部署版-数据落盘无惧丢失"}},[s._v("#")]),s._v(" 6.2.2 完整部署版（数据落盘无惧丢失）")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("校验脚本执行口令，防止误操作")]),s._v(" "),e("ul",[e("li",[s._v("输出一段文字说明")]),s._v(" "),e("li",[s._v("等待接收"),e("code",[s._v("Doris")]),s._v("这五个字母，成功则继续，未成功则终止")])])]),s._v(" "),e("li",[e("p",[s._v("依次询问参数配置设置，接收参数，可参考的有：")]),s._v(" "),e("blockquote",[e("ol",[e("li",[s._v("是否默认配置安装（Y/N）")]),s._v(" "),e("li",[s._v("BE数量（默认为3）")]),s._v(" "),e("li",[s._v("root密码（默认为空）")]),s._v(" "),e("li",[s._v("操作员账户名称（默认无）")]),s._v(" "),e("li",[s._v("操作员账户密码（默认无）")]),s._v(" "),e("li",[s._v("FE-Http-Port端口（默认8030）")]),s._v(" "),e("li",[s._v("FE-MySQL-Cli-Port端口（默认9030）")])])])]),s._v(" "),e("li",[e("p",[s._v("创建宿主机资源目录并进入")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/docker/doris/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/docker/doris/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("拉取编译好的文件包至上述目录（当前版本为Apache Doris-1.0.0 bate测试版）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://jiafeng2022.oss-cn-beijing.aliyuncs.com/doris-1.0.0-jdk8-20220301.tar.gz\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("解压文件包")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("tar -zxvf /opt/docker/doris/apache-doris-install.tar.gz\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("根据传参的BE数量循环复制BE目录，以默认数量为样例，命令执行为")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /opt/docker/doris/be /opt/docker/doris/be-01\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /opt/docker/doris/be /opt/docker/doris/be-02\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -r /opt/docker/doris/be /opt/docker/doris/be-03\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("监测Docker是否安装")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("如果已安装则跳过，未安装则安装Docker")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监测内核版本，若小于3.10则终止安装并通知失败，告知失败原因")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -r\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果大于3.10则开始安装，依次执行以下命令")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum update -y\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils device-mapper-persistent-data lvm2\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce -y\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl start "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行结束，监测执行是否都已成功")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("监测MySQL-Client是否已安装")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mysql --version\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("如果已安装则跳过，未安装则安装MySQL-Client")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/software\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/software\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.37-1.el7.x86_64.rpm-bundle.tar\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -xvf mysql-5.7.37-1.el7.x86_64.rpm-bundle.tar\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-common-5.7.37-1.el7.x86_64.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-libs-5.7.37-1.el7.x86_64.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-client-5.7.37-1.el7.x86_64.rpm\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("拉取Doris编译镜像为基础环境镜像")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull apache/incubator-doris:build-env-ldb-toolchain-latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("制作FE容器")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("构建FE容器")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8030")]),s._v(":8030 -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9030")]),s._v(":9030 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-fe -v /opt/docker/doris/fe:/opt/doris/fe -v /opt/docker/doris/doris-meta:/opt/doris/doris-meta apache/incubator-doris:build-env-ldb-toolchain-latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("进入容器")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -ti doris-fe /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("修改FE配置文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /opt/doris/fe/conf/fe.conf\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如FE两个对外端口都是默认值，则无需修改，若有改变，则改变该值")]),s._v("\nhttp_port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8030")]),s._v("\nquery_port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9030")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改网段")]),s._v("\npriority_networks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.0/16\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("切换JDK版本")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换Java版本为JDK1.8，该镜像默认为JDK11")]),s._v("\nalternatives --set java java-1.8.0-openjdk.x86_64\nalternatives --set javac java-1.8.0-openjdk.x86_64\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/lib/jvm/java-1.8.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("配置Doris环境变量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置环境变量")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile.d/doris.sh\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DORIS_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/doris/fe/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DORIS_HOME")]),s._v("/bin\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存并source")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile.d/doris.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("安装Net-Tools工具以便于查看IP地址")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("使用命令查看该Docker的IPv4地址，并记录下来")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动FE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("start_fe.sh\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最好执行命令以后再等待10秒左右")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("退出该容器，返回宿主机")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])])]),s._v(" "),e("li",[e("p",[s._v("用MySQL-Client连接Doris")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("mysql -h "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${记录下的FE-Docker的IPv4地址}")]),s._v(" -P "),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${默认9030，如有改变则使用改变后的query-port}")]),s._v(" -uroot\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("注册BE至FE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("ALTER SYSTEM ADD BACKEND "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${FE-Docker的IPv4地址的第四位自增1}")]),s._v(':9050"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里需要说明的是，这命令执行时应该是根据BE的数量来循环的，比如BE为默认值3，记录下FE-Docker的地址为172.17.0.3，那么就应该循环添加 172.17.0.4:9050、172.17.0.5:9050、172.17.0.6:9050三条注册信息，以此类推")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("若有用户修改密码和注册了操作员账户，则执行以下命令")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改密码")]),s._v("\nSET PASSWORD FOR "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PASSWORD"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'${填写的root密码}'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 也可以创建新用户")]),s._v("\nCREATE "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'${填写的操作员账户}'")]),s._v(" IDENTIFIED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'${填写的操作员密码}'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("退出MySQL-Client")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("制作BE容器，该处应该进入以BE数量为最大数值从1开始的循环中（以BE-01为例）")]),s._v(" "),e("p",[e("strong",[s._v("假设BE的节点数量从1自增的变量为n，在以下示例中取值方式为"),e("code",[s._v("${n}")])])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("构建BE容器")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 标准格式为如下所示，其中三处被替换为${n}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("906")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${n}")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-0"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${n}")]),s._v(" -v /opt/docker/doris/be-0"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${n}")]),s._v(":/opt/doris/be apache/incubator-doris:build-env-ldb-toolchain-latest\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 示例")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9061")]),s._v(":9060 -d --name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("doris-be-01 -v /opt/docker/doris/be-01:/opt/doris/be apache/incubator-doris:build-env-ldb-toolchain-latest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("进入容器")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里需要注意，也是要根据循环进行取值")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -ti doris-be-0"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${n}")]),s._v(" /bin/bash\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("修改BE配置文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /opt/doris/be/conf/be.conf\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消priority_networks的注解，并根据Docker的网段进行配置")]),s._v("\npriority_networks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.0/16 "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这里要根据你Docker的IP确定")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("配置BE环境变量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置环境变量")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile.d/doris.sh\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DORIS_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/doris/be/\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DORIS_HOME")]),s._v("/bin\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存并source")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile.d/doris.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动BE")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("start_be.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("退出容器，开始下一次循环")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])])]),s._v(" "),e("li",[e("p",[s._v("循环结束，清除临时解压缩及部分下载文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /opt/software/*.rpm\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /opt/docker/doris/apache-doris-install.tar.gz\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("制作启动、停止脚本（前提Docker容器是启动的，若未启动则报错）")]),s._v(" "),e("p",[s._v("启动脚本需以"),e("code",[s._v("start_doris_docker.sh")]),s._v("命名，停止脚本以"),e("code",[s._v("stop_doris_docker.sh")]),s._v("命名")]),s._v(" "),e("p",[s._v("两个脚本均写在"),e("code",[s._v("/opt/docker/doris/sbin/")]),s._v("目录下")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("创建目录")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/docker/doris/sbin/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("启动脚本内容")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("启动FE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-fe /bin/bash /opt/doris/fe/start_fe.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("循环启动BE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-be-0"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${n}")]),s._v(" /bin/bash /opt/doris/be/start_be.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])])]),s._v(" "),e("li",[e("p",[s._v("停止脚本内容")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("循环停止BE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-be-0"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${n}")]),s._v(" /bin/bash /opt/doris/be/stop_be.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("停止FE")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -d doris-fe /bin/bash /opt/doris/fe/stop_fe.sh --daemon\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])])]),s._v(" "),e("li",[e("p",[s._v("配置环境变量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile.d/doris-docker.sh\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DORIS_DOCKER_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/docker/doris/sbin\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DORIS_DOCKER_HOME")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("刷新环境变量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile.d/doris-docker.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])])])]),s._v(" "),e("h2",{attrs:{id:"成果"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#成果"}},[s._v("#")]),s._v(" 成果")]),s._v(" "),e("p",[e("strong",[s._v("极速体验版部署流程")]),s._v("（此脚本部署将部署最新版本Apache Doris）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.freeoneplus.com/doris/doris_docker_fast_install.sh\n./doris_docker_fast_install.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("strong",[s._v("完全部署版部署流程")]),s._v("（此脚本部署将部署最新版本Apache Doris）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.freeoneplus.com/doris/doris_docker_whole_install.sh\n./doris_docker_whole_install.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("strong",[s._v("假设需要指定版本的部署，请使用以下部署流程")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 极速体验版部署流程")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.freeoneplus.com/doris/doris_docker_fast_install_"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${指定版本号}")]),s._v(".sh\n./doris_docker_fast_install_"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${指定版本号}")]),s._v(".sh\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 案例：极速体验版 Apache Doris 0.15版本")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.freeoneplus.com/doris/doris_docker_fast_install_0.15.sh\n./doris_docker_fast_install_0.15.sh\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 完全部署版部署流程")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.freeoneplus.com/doris/doris_docker_whole_install_"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${指定版本号}")]),s._v(".sh\n./doris_docker_whole_install_"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${指定版本号}")]),s._v(".sh\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 案例：完全部署版 Apache Doris 0.15版本")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.freeoneplus.com/doris/doris_docker_whole_install_0.15.sh\n./doris_docker_whole_install_0.15.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[e("strong",[s._v("当前支持版本对照表")])]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("Apache Doris version")]),s._v(" "),e("th",[s._v("是否支持")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("1.0.0-beta")]),s._v(" "),e("td",[s._v("支持")])]),s._v(" "),e("tr",[e("td",[s._v("0.15")]),s._v(" "),e("td",[s._v("3月8日起支持")])]),s._v(" "),e("tr",[e("td",[s._v("0.14及以下")]),s._v(" "),e("td",[s._v("不支持")])])])])])}),[],!1,null,null,null);a.default=n.exports}}]);