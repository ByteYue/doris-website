(window.webpackJsonp=window.webpackJsonp||[]).push([[1289],{1914:function(t,s,e){"use strict";e.r(s);var a=e(15),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"import-strict-mode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#import-strict-mode"}},[t._v("#")]),t._v(" import strict mode")]),t._v(" "),e("p",[t._v("Strict mode (strict_mode) is configured as a parameter in the import operation. This parameter affects the import behavior of certain values and the final imported data.")]),t._v(" "),e("p",[t._v("This document mainly explains how to set strict mode, and the impact of strict mode.")]),t._v(" "),e("h2",{attrs:{id:"how-to-set"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-set"}},[t._v("#")]),t._v(" How to set")]),t._v(" "),e("p",[t._v("Strict mode is all False by default, i.e. off.")]),t._v(" "),e("p",[t._v("Different import methods set strict mode in different ways.")]),t._v(" "),e("ol",[e("li",[e("p",[e("RouterLink",{attrs:{to:"/docs/sql-manual/sql-reference/Data-Manipulation-Statements/Load/BROKER-LOAD.html"}},[t._v("BROKER LOAD")])],1),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LOAD")]),t._v(" LABEL example_db"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("label1\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DATA")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INFILE")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bos://my_bucket/input/file.txt"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token identifier"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("my_table"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLUMNS")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TERMINATED")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WITH")]),t._v(" BROKER bos\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bos_endpoint"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://bj.bcebos.com"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bos_accesskey"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxxxxxxxxxxxxxxxxxxxxxx"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bos_secret_accesskey"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yyyyyyyyyyyyyyyyyyyyyyyy"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nPROPERTIES\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"strict_mode"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br")])])]),t._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/docs/sql-manual/sql-reference/Data-Manipulation-Statements/Load/STREAM-LOAD.html"}},[t._v("STREAM LOAD")])],1),t._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" --location-trusted -u user:passwd "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n-H "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"strict_mode: true"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n-T "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".txt "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nhttp://host:port/api/example_db/my_table/_stream_load\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])]),t._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/docs/sql-manual/sql-reference/Data-Manipulation-Statements/Load/CREATE-ROUTINE-LOAD.html"}},[t._v("ROUTINE LOAD")])],1),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROUTINE")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LOAD")]),t._v(" example_db"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("test_job "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" my_table\nPROPERTIES\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"strict_mode"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" KAFKA\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kafka_broker_list"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"broker1:9092,broker2:9092,broker3:9092"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kafka_topic"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my_topic"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br")])])]),t._v(" "),e("li",[e("p",[e("RouterLink",{attrs:{to:"/docs/sql-manual/sql-reference/Data-Manipulation-Statements/Manipulation/INSERT.html"}},[t._v("INSERT")])],1),t._v(" "),e("p",[t._v("Set via "),e("RouterLink",{attrs:{to:"/docs/advanced/variables.html"}},[t._v("session variables")]),t._v(":")],1),t._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" enable_insert_strict "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" my_table "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])])])]),t._v(" "),e("h2",{attrs:{id:"the-role-of-strict-mode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-role-of-strict-mode"}},[t._v("#")]),t._v(" The role of strict mode")]),t._v(" "),e("p",[t._v("Strict mode means strict filtering of column type conversions during import.")]),t._v(" "),e("p",[t._v("The strict filtering strategy is as follows:")]),t._v(" "),e("p",[t._v("For column type conversion, if strict mode is turned on, the wrong data will be filtered. The wrong data here refers to: the original data is not "),e("code",[t._v("null")]),t._v(", but the result is "),e("code",[t._v("null")]),t._v(" after column type conversion.")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("column type conversion")]),t._v(" mentioned here does not include the "),e("code",[t._v("null")]),t._v(" value calculated by the function.")]),t._v(" "),e("p",[t._v("For an imported column type that contains range restrictions, if the original data can pass the type conversion normally, but cannot pass the range restrictions, strict mode will not affect it. For example: if the type is "),e("code",[t._v("decimal(1,0)")]),t._v(" and the original data is 10, it belongs to the range that can be converted by type but is not within the scope of the column declaration. This kind of data strict has no effect on it.")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Take the column type as TinyInt as an example:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Primitive data type")]),t._v(" "),e("th",[t._v("Primitive data example")]),t._v(" "),e("th",[t._v("Converted value to TinyInt")]),t._v(" "),e("th",[t._v("Strict mode")]),t._v(" "),e("th",[t._v("Result")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("NULL")]),t._v(" "),e("td",[t._v("\\N")]),t._v(" "),e("td",[t._v("NULL")]),t._v(" "),e("td",[t._v("ON or OFF")]),t._v(" "),e("td",[t._v("NULL")])]),t._v(" "),e("tr",[e("td",[t._v("Non-null value")]),t._v(" "),e("td",[t._v('"abc" or 2000')]),t._v(" "),e("td",[t._v("NULL")]),t._v(" "),e("td",[t._v("On")]),t._v(" "),e("td",[t._v("Illegal value (filtered)")])]),t._v(" "),e("tr",[e("td",[t._v("non-null value")]),t._v(" "),e("td",[t._v('"abc"')]),t._v(" "),e("td",[t._v("NULL")]),t._v(" "),e("td",[t._v("off")]),t._v(" "),e("td",[t._v("NULL")])]),t._v(" "),e("tr",[e("td",[t._v("non-null value")]),t._v(" "),e("td",[t._v("1")]),t._v(" "),e("td",[t._v("1")]),t._v(" "),e("td",[t._v("on or off")]),t._v(" "),e("td",[t._v("import correctly")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("Description:")]),t._v(" "),e("ol",[e("li",[t._v("Columns in the table allow to import null values")]),t._v(" "),e("li",[t._v("After "),e("code",[t._v("abc")]),t._v(" and "),e("code",[t._v("2000")]),t._v(" are converted to TinyInt, they will become NULL due to type or precision issues. When strict mode is on, this data will be filtered. And if it is closed, "),e("code",[t._v("null")]),t._v(" will be imported.")])])])]),t._v(" "),e("li",[e("p",[t._v("Take the column type as Decimal(1,0) as an example")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Primitive Data Types")]),t._v(" "),e("th",[t._v("Examples of Primitive Data")]),t._v(" "),e("th",[t._v("Converted to Decimal")]),t._v(" "),e("th",[t._v("Strict Mode")]),t._v(" "),e("th",[t._v("Result")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("Null")]),t._v(" "),e("td",[t._v("\\N")]),t._v(" "),e("td",[t._v("null")]),t._v(" "),e("td",[t._v("On or Off")]),t._v(" "),e("td",[t._v("NULL")])]),t._v(" "),e("tr",[e("td",[t._v("non-null value")]),t._v(" "),e("td",[t._v("aaa")]),t._v(" "),e("td",[t._v("NULL")]),t._v(" "),e("td",[t._v("on")]),t._v(" "),e("td",[t._v("illegal value (filtered)")])]),t._v(" "),e("tr",[e("td",[t._v("non-null value")]),t._v(" "),e("td",[t._v("aaa")]),t._v(" "),e("td",[t._v("NULL")]),t._v(" "),e("td",[t._v("off")]),t._v(" "),e("td",[t._v("NULL")])]),t._v(" "),e("tr",[e("td",[t._v("non-null value")]),t._v(" "),e("td",[t._v("1 or 10")]),t._v(" "),e("td",[t._v("1 or 10")]),t._v(" "),e("td",[t._v("on or off")]),t._v(" "),e("td",[t._v("import correctly")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("Description:")]),t._v(" "),e("ol",[e("li",[t._v("Columns in the table allow to import null values")]),t._v(" "),e("li",[t._v("After "),e("code",[t._v("abc")]),t._v(" is converted to Decimal, it will become NULL due to type problem. When strict mode is on, this data will be filtered. And if it is closed, "),e("code",[t._v("null")]),t._v(" will be imported.")]),t._v(" "),e("li",[t._v("Although "),e("code",[t._v("10")]),t._v(" is an out-of-range value, because its type conforms to the requirements of decimal, strict mode does not affect it. "),e("code",[t._v("10")]),t._v(" will eventually be filtered in other import processing flows. But not filtered by strict mode.")])])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);