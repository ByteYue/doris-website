(window.webpackJsonp=window.webpackJsonp||[]).push([[818],{1248:function(s,t,a){"use strict";a.r(t);var n=a(2),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"spark-doris-connector"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spark-doris-connector"}},[s._v("#")]),s._v(" Spark Doris Connector")]),s._v(" "),a("p",[s._v("Spark Doris Connector 可以支持通过 Spark 读取 Doris 中存储的数据，也支持通过Spark写入数据到Doris。")]),s._v(" "),a("p",[s._v("代码库地址：https://github.com/apache/incubator-doris-spark-connector")]),s._v(" "),a("ul",[a("li",[s._v("支持从"),a("code",[s._v("Doris")]),s._v("中读取数据")]),s._v(" "),a("li",[s._v("支持"),a("code",[s._v("Spark DataFrame")]),s._v("批量/流式 写入"),a("code",[s._v("Doris")])]),s._v(" "),a("li",[s._v("可以将"),a("code",[s._v("Doris")]),s._v("表映射为"),a("code",[s._v("DataFrame")]),s._v("或者"),a("code",[s._v("RDD")]),s._v("，推荐使用"),a("code",[s._v("DataFrame")]),s._v("。")]),s._v(" "),a("li",[s._v("支持在"),a("code",[s._v("Doris")]),s._v("端完成数据过滤，减少数据传输量。")])]),s._v(" "),a("h2",{attrs:{id:"版本兼容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#版本兼容"}},[s._v("#")]),s._v(" 版本兼容")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Connector")]),s._v(" "),a("th",[s._v("Spark")]),s._v(" "),a("th",[s._v("Doris")]),s._v(" "),a("th",[s._v("Java")]),s._v(" "),a("th",[s._v("Scala")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("2.3.4-2.11.xx")]),s._v(" "),a("td",[s._v("2.x")]),s._v(" "),a("td",[s._v("0.12+")]),s._v(" "),a("td",[s._v("8")]),s._v(" "),a("td",[s._v("2.11")])]),s._v(" "),a("tr",[a("td",[s._v("3.1.2-2.12.xx")]),s._v(" "),a("td",[s._v("3.x")]),s._v(" "),a("td",[s._v("0.12.+")]),s._v(" "),a("td",[s._v("8")]),s._v(" "),a("td",[s._v("2.12")])]),s._v(" "),a("tr",[a("td",[s._v("3.2.0-2.12.xx")]),s._v(" "),a("td",[s._v("3.2.x")]),s._v(" "),a("td",[s._v("0.12.+")]),s._v(" "),a("td",[s._v("8")]),s._v(" "),a("td",[s._v("2.12")])])])]),s._v(" "),a("h2",{attrs:{id:"编译与安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译与安装"}},[s._v("#")]),s._v(" 编译与安装")]),s._v(" "),a("p",[s._v("准备工作")]),s._v(" "),a("p",[s._v("1.修改"),a("code",[s._v("custom_env.sh.tpl")]),s._v("文件，重命名为"),a("code",[s._v("custom_env.sh")])]),s._v(" "),a("p",[s._v("2.指定thrift安装目录")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##源文件内容")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#export THRIFT_BIN=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#export MVN_BIN=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#export JAVA_HOME=")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##修改如下,MacOS为例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("THRIFT_BIN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/homebrew/Cellar/thrift@0.13.0/0.13.0/bin/thrift\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#export MVN_BIN=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#export JAVA_HOME=")]),s._v("\n\n安装 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("thrift"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.13")]),s._v(".0 版本"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("注意："),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("Doris"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.15")]),s._v(" 和最新的版本基于 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("thrift"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.13")]),s._v(".0 构建, 之前的版本依然使用"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("thrift"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),s._v(".3 构建"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n Windows: \n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".下载："),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("http://archive.apache.org/dist/thrift/0.13.0/thrift-0.13.0.exe"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("下载目录自己指定"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".修改thrift-0.13.0.exe 为 thrift\n \n MacOS: \n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". 下载："),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" thrift@0.13.0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". 默认下载地址：/opt/homebrew/Cellar/thrift@0.13.0/0.13.0/bin/thrift\n    \n \n 注：MacOS执行 "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" thrift@0.13.0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" 可能会报找不到版本的错误，解决方法如下，在终端执行：\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("brew tap-new "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v("/local-tap"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("brew extract --version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0.13.0'")]),s._v(" thrift "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v("/local-tap"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" thrift@0.13.0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n 参考链接: "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("https://gist.github.com/tonydeng/02e571f273d6cce4230dc8d5f394493c"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n \n Linux:\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".下载源码包："),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://archive.apache.org/dist/thrift/0.13.0/thrift-0.13.0.tar.gz"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".安装依赖："),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y autoconf automake libtool cmake ncurses-devel openssl-devel lzo-devel zlib-devel gcc gcc-c++"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("."),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxvf thrift-0.13.0.tar.gz"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("."),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" thrift-0.13.0"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("."),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("./configure --without-tests"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("."),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("."),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n   安装完成后查看版本：thrift --version  \n   注：如果编译过Doris，则不需要安装thrift,可以直接使用 "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DORIS_HOME")]),s._v("/thirdparty/installed/bin/thrift\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("p",[s._v("在源码目录下执行：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" build.sh --spark "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.3")]),s._v(".4 --scala "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.11")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## spark 2.3.4, scala 2.11")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" build.sh --spark "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.1")]),s._v(".2 --scala "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## spark 3.1.2, scala 2.12")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" build.sh --spark "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(".0 --scala "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--mvn-args "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Dnetty.version=4.1.68.Final -Dfasterxml.jackson.version=2.12.3"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## spark 3.2.0, scala 2.12")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v("注：如果你是从 tag 检出的源码，则可以直接执行 "),a("code",[s._v("sh build.sh --tag")]),s._v("，而无需指定 spark 和 scala 的版本。因为 tag 源码中的版本是固定的。")])]),s._v(" "),a("p",[s._v("编译成功后，会在 "),a("code",[s._v("output/")]),s._v(" 目录下生成文件 "),a("code",[s._v("doris-spark-2.3.4-2.11-1.0.0-SNAPSHOT.jar")]),s._v("。将此文件复制到 "),a("code",[s._v("Spark")]),s._v(" 的 "),a("code",[s._v("ClassPath")]),s._v(" 中即可使用 "),a("code",[s._v("Spark-Doris-Connector")]),s._v("。例如，"),a("code",[s._v("Local")]),s._v(" 模式运行的 "),a("code",[s._v("Spark")]),s._v("，将此文件放入 "),a("code",[s._v("jars/")]),s._v(" 文件夹下。"),a("code",[s._v("Yarn")]),s._v("集群模式运行的"),a("code",[s._v("Spark")]),s._v("，则将此文件放入预部署包中。")]),s._v(" "),a("p",[s._v("例如将 "),a("code",[s._v("doris-spark-2.3.4-2.11-1.0.0-SNAPSHOT.jar")]),s._v(" 上传到 hdfs并在spark.yarn.jars参数上添加 hdfs上的Jar包路径")]),s._v(" "),a("ol",[a("li",[s._v("上传doris-spark-connector-3.1.2-2.12-1.0.0.jar 到hdfs。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("hdfs dfs -mkdir /spark-jars/\nhdfs dfs -put /your_local_path/doris-spark-connector-3.1.2-2.12-1.0.0.jar /spark-jars/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("在集群中添加doris-spark-connector-3.1.2-2.12-1.0.0.jar 依赖。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("spark.yarn.jars=hdfs:///spark-jars/doris-spark-connector-3.1.2-2.12-1.0.0.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"使用maven管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用maven管理"}},[s._v("#")]),s._v(" 使用Maven管理")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<dependency>\n  <groupId>org.apache.doris</groupId>\n  <artifactId>spark-doris-connector-3.1_2.12</artifactId>\n  \x3c!--artifactId>spark-doris-connector-2.3_2.11</artifactId--\x3e\n  <version>1.0.1</version>\n</dependency>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[a("strong",[s._v("注意")])]),s._v(" "),a("p",[s._v("请根据不同的 Spark 和 Scala 版本替换相应的 Connector 版本。")]),s._v(" "),a("h2",{attrs:{id:"使用示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[s._v("#")]),s._v(" 使用示例")]),s._v(" "),a("h3",{attrs:{id:"读取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取"}},[s._v("#")]),s._v(" 读取")]),s._v(" "),a("h4",{attrs:{id:"sql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql"}},[s._v("#")]),s._v(" SQL")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TEMPORARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" spark_doris\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USING")]),s._v(" doris\nOPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"table.identifier"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fenodes"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" spark_doris"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h4",{attrs:{id:"dataframe"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dataframe"}},[s._v("#")]),s._v(" DataFrame")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" dorisSparkDF "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" spark"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.table.identifier"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.fenodes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndorisSparkDF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h4",{attrs:{id:"rdd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rdd"}},[s._v("#")]),s._v(" RDD")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("doris"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("spark"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("_\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" dorisSparkRDD "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dorisRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  tableIdentifier "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Some"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  cfg "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Some"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.fenodes"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.request.auth.user"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.request.auth.password"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndorisSparkRDD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("collect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h4",{attrs:{id:"pyspark"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pyspark"}},[s._v("#")]),s._v(" pySpark")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("dorisSparkDF "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" spark"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.table.identifier"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.fenodes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n# show "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" lines data \ndorisSparkDF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"写入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写入"}},[s._v("#")]),s._v(" 写入")]),s._v(" "),a("h4",{attrs:{id:"sql-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql-2"}},[s._v("#")]),s._v(" SQL")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TEMPORARY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VIEW")]),s._v(" spark_doris\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USING")]),s._v(" doris\nOPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"table.identifier"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fenodes"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" spark_doris "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"VALUE1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"VALUE2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" spark_doris "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" YOUR_TABLE\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h4",{attrs:{id:"dataframe-batch-stream"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dataframe-batch-stream"}},[s._v("#")]),s._v(" DataFrame(batch/stream)")]),s._v(" "),a("div",{staticClass:"language-scala line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[s._v("## batch sink\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" mockDataDF "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" List"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"440403001005"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"21.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"4404030013005"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"22.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"23.cn"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("toDF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mi_code"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mi_name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmockDataDF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("show"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmockDataDF"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.table.identifier"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.fenodes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//其它选项")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//指定你要写入的字段")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.write.fields"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_FIELDS_TO_WRITE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n## stream sink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("StructuredStreaming"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("val")]),s._v(" kafkaSource "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" spark"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("readStream\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kafka.bootstrap.servers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_KAFKA_SERVERS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"startingOffsets"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latest"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subscribe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_KAFKA_TOPICS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kafka"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nkafkaSource"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("selectExpr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CAST(key AS STRING)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CAST(value as STRING)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("writeStream\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("format"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"checkpointLocation"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_CHECKPOINT_LOCATION"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.table.identifier"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_DATABASE_NAME.$YOUR_DORIS_TABLE_NAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.fenodes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_FE_HOSTNAME:$YOUR_DORIS_FE_RESFUL_PORT"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_USERNAME"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_DORIS_PASSWORD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//其它选项")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//指定你要写入的字段")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doris.write.fields"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"$YOUR_FIELDS_TO_WRITE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("awaitTermination"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("h3",{attrs:{id:"java示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#java示例"}},[s._v("#")]),s._v(" java示例")]),s._v(" "),a("p",[a("code",[s._v("samples/doris-demo/spark-demo/")]),s._v(" 下提供了 Java 版本的示例，可供参考，"),a("a",{attrs:{href:"https://github.com/apache/incubator-doris/tree/master/samples/doris-demo/spark-demo",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),a("h3",{attrs:{id:"通用配置项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通用配置项"}},[s._v("#")]),s._v(" 通用配置项")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Key")]),s._v(" "),a("th",[s._v("Default Value")]),s._v(" "),a("th",[s._v("Comment")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("doris.fenodes")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("Doris FE http 地址，支持多个地址，使用逗号分隔")])]),s._v(" "),a("tr",[a("td",[s._v("doris.table.identifier")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("Doris 表名，如：db1.tbl1")])]),s._v(" "),a("tr",[a("td",[s._v("doris.request.retries")]),s._v(" "),a("td",[s._v("3")]),s._v(" "),a("td",[s._v("向Doris发送请求的重试次数")])]),s._v(" "),a("tr",[a("td",[s._v("doris.request.connect.timeout.ms")]),s._v(" "),a("td",[s._v("30000")]),s._v(" "),a("td",[s._v("向Doris发送请求的连接超时时间")])]),s._v(" "),a("tr",[a("td",[s._v("doris.request.read.timeout.ms")]),s._v(" "),a("td",[s._v("30000")]),s._v(" "),a("td",[s._v("向Doris发送请求的读取超时时间")])]),s._v(" "),a("tr",[a("td",[s._v("doris.request.query.timeout.s")]),s._v(" "),a("td",[s._v("3600")]),s._v(" "),a("td",[s._v("查询doris的超时时间，默认值为1小时，-1表示无超时限制")])]),s._v(" "),a("tr",[a("td",[s._v("doris.request.tablet.size")]),s._v(" "),a("td",[s._v("Integer.MAX_VALUE")]),s._v(" "),a("td",[s._v("一个RDD Partition对应的Doris Tablet个数。"),a("br"),s._v("此数值设置越小，则会生成越多的Partition。从而提升Spark侧的并行度，但同时会对Doris造成更大的压力。")])]),s._v(" "),a("tr",[a("td",[s._v("doris.batch.size")]),s._v(" "),a("td",[s._v("1024")]),s._v(" "),a("td",[s._v("一次从BE读取数据的最大行数。增大此数值可减少Spark与Doris之间建立连接的次数。"),a("br"),s._v("从而减轻网络延迟所带来的额外时间开销。")])]),s._v(" "),a("tr",[a("td",[s._v("doris.exec.mem.limit")]),s._v(" "),a("td",[s._v("2147483648")]),s._v(" "),a("td",[s._v("单个查询的内存限制。默认为 2GB，单位为字节")])]),s._v(" "),a("tr",[a("td",[s._v("doris.deserialize.arrow.async")]),s._v(" "),a("td",[s._v("false")]),s._v(" "),a("td",[s._v("是否支持异步转换Arrow格式到spark-doris-connector迭代所需的RowBatch")])]),s._v(" "),a("tr",[a("td",[s._v("doris.deserialize.queue.size")]),s._v(" "),a("td",[s._v("64")]),s._v(" "),a("td",[s._v("异步转换Arrow格式的内部处理队列，当doris.deserialize.arrow.async为true时生效")])]),s._v(" "),a("tr",[a("td",[s._v("doris.write.fields")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("指定写入Doris表的字段或者字段顺序，多列之间使用逗号分隔。"),a("br"),s._v("默认写入时要按照Doris表字段顺序写入全部字段。")])]),s._v(" "),a("tr",[a("td",[s._v("sink.batch.size")]),s._v(" "),a("td",[s._v("10000")]),s._v(" "),a("td",[s._v("单次写BE的最大行数")])]),s._v(" "),a("tr",[a("td",[s._v("sink.max-retries")]),s._v(" "),a("td",[s._v("1")]),s._v(" "),a("td",[s._v("写BE失败之后的重试次数")])])])]),s._v(" "),a("h3",{attrs:{id:"sql-和-dataframe-专有配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql-和-dataframe-专有配置"}},[s._v("#")]),s._v(" SQL 和 Dataframe 专有配置")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Key")]),s._v(" "),a("th",[s._v("Default Value")]),s._v(" "),a("th",[s._v("Comment")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("user")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("访问Doris的用户名")])]),s._v(" "),a("tr",[a("td",[s._v("password")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("访问Doris的密码")])]),s._v(" "),a("tr",[a("td",[s._v("doris.filter.query.in.max.count")]),s._v(" "),a("td",[s._v("100")]),s._v(" "),a("td",[s._v("谓词下推中，in表达式value列表元素最大数量。超过此数量，则in表达式条件过滤在Spark侧处理。")])])])]),s._v(" "),a("h3",{attrs:{id:"rdd-专有配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rdd-专有配置"}},[s._v("#")]),s._v(" RDD 专有配置")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Key")]),s._v(" "),a("th",[s._v("Default Value")]),s._v(" "),a("th",[s._v("Comment")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("doris.request.auth.user")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("访问Doris的用户名")])]),s._v(" "),a("tr",[a("td",[s._v("doris.request.auth.password")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("访问Doris的密码")])]),s._v(" "),a("tr",[a("td",[s._v("doris.read.field")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("读取Doris表的列名列表，多列之间使用逗号分隔")])]),s._v(" "),a("tr",[a("td",[s._v("doris.filter.query")]),s._v(" "),a("td",[s._v("--")]),s._v(" "),a("td",[s._v("过滤读取数据的表达式，此表达式透传给Doris。Doris使用此表达式完成源端数据过滤。")])])])]),s._v(" "),a("h2",{attrs:{id:"doris-和-spark-列类型映射关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#doris-和-spark-列类型映射关系"}},[s._v("#")]),s._v(" Doris 和 Spark 列类型映射关系")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Doris Type")]),s._v(" "),a("th",[s._v("Spark Type")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("NULL_TYPE")]),s._v(" "),a("td",[s._v("DataTypes.NullType")])]),s._v(" "),a("tr",[a("td",[s._v("BOOLEAN")]),s._v(" "),a("td",[s._v("DataTypes.BooleanType")])]),s._v(" "),a("tr",[a("td",[s._v("TINYINT")]),s._v(" "),a("td",[s._v("DataTypes.ByteType")])]),s._v(" "),a("tr",[a("td",[s._v("SMALLINT")]),s._v(" "),a("td",[s._v("DataTypes.ShortType")])]),s._v(" "),a("tr",[a("td",[s._v("INT")]),s._v(" "),a("td",[s._v("DataTypes.IntegerType")])]),s._v(" "),a("tr",[a("td",[s._v("BIGINT")]),s._v(" "),a("td",[s._v("DataTypes.LongType")])]),s._v(" "),a("tr",[a("td",[s._v("FLOAT")]),s._v(" "),a("td",[s._v("DataTypes.FloatType")])]),s._v(" "),a("tr",[a("td",[s._v("DOUBLE")]),s._v(" "),a("td",[s._v("DataTypes.DoubleType")])]),s._v(" "),a("tr",[a("td",[s._v("DATE")]),s._v(" "),a("td",[s._v("DataTypes.StringType"),a("sup",[s._v("1")])])]),s._v(" "),a("tr",[a("td",[s._v("DATETIME")]),s._v(" "),a("td",[s._v("DataTypes.StringType"),a("sup",[s._v("1")])])]),s._v(" "),a("tr",[a("td",[s._v("BINARY")]),s._v(" "),a("td",[s._v("DataTypes.BinaryType")])]),s._v(" "),a("tr",[a("td",[s._v("DECIMAL")]),s._v(" "),a("td",[s._v("DecimalType")])]),s._v(" "),a("tr",[a("td",[s._v("CHAR")]),s._v(" "),a("td",[s._v("DataTypes.StringType")])]),s._v(" "),a("tr",[a("td",[s._v("LARGEINT")]),s._v(" "),a("td",[s._v("DataTypes.StringType")])]),s._v(" "),a("tr",[a("td",[s._v("VARCHAR")]),s._v(" "),a("td",[s._v("DataTypes.StringType")])]),s._v(" "),a("tr",[a("td",[s._v("DECIMALV2")]),s._v(" "),a("td",[s._v("DecimalType")])]),s._v(" "),a("tr",[a("td",[s._v("TIME")]),s._v(" "),a("td",[s._v("DataTypes.DoubleType")])]),s._v(" "),a("tr",[a("td",[s._v("HLL")]),s._v(" "),a("td",[s._v("Unsupported datatype")])])])]),s._v(" "),a("ul",[a("li",[s._v("注：Connector中，将"),a("code",[s._v("DATE")]),s._v("和"),a("code",[s._v("DATETIME")]),s._v("映射为"),a("code",[s._v("String")]),s._v("。由于"),a("code",[s._v("Doris")]),s._v("底层存储引擎处理逻辑，直接使用时间类型时，覆盖的时间范围无法满足需求。所以使用 "),a("code",[s._v("String")]),s._v(" 类型直接返回对应的时间可读文本。")])])])}),[],!1,null,null,null);t.default=r.exports}}]);