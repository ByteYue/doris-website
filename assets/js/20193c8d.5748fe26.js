"use strict";(self.webpackChunkselectdb_portal=self.webpackChunkselectdb_portal||[]).push([[38823],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>u});var o=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r,o,a={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},d=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(r),u=a,m=p["".concat(l,".").concat(u)]||p[u]||h[u]||n;return r?o.createElement(m,i(i({ref:t},d),{},{components:r})):o.createElement(m,i({ref:t},d))}));function u(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,i=new Array(n);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<n;c++)i[c]=r[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}p.displayName="MDXCreateElement"},65039:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>n,metadata:()=>s,toc:()=>c});var o=r(87462),a=(r(67294),r(3905));const n={title:"Common Error",language:"en"},i=void 0,s={unversionedId:"faq/error",id:"version-1.0/faq/error",title:"Common Error",description:"\x3c!--",source:"@site/versioned_docs/version-1.0/faq/error.md",sourceDirName:"faq",slug:"/faq/error",permalink:"/docs/1.0/faq/error",draft:!1,tags:[],version:"1.0",frontMatter:{title:"Common Error",language:"en"},sidebar:"docs",previous:{title:"FAQ",permalink:"/docs/1.0/faq/"}},l={},c=[{value:"E1. Query error: Failed to get scan range, no queryable replica found in tablet: xxxx",id:"e1-query-error-failed-to-get-scan-range-no-queryable-replica-found-in-tablet-xxxx",level:3},{value:"E2. FE failed to start, fe.log keeps scrolling &quot;wait catalog to be ready. FE type UNKNOWN&quot;",id:"e2-fe-failed-to-start-felog-keeps-scrolling-wait-catalog-to-be-ready-fe-type-unknown",level:3},{value:"E3. tablet writer write failed, tablet_id=27306172, txn_id=28573520, err=-235 or -215 or -238",id:"e3-tablet-writer-write-failed-tablet_id27306172-txn_id28573520-err-235-or--215-or--238",level:3},{value:"E4. tablet 110309738 has few replicas: 1, alive backends: 10003",id:"e4-tablet-110309738-has-few-replicas-1-alive-backends-10003",level:3},{value:"E5. disk xxxxx on backend xxx exceed limit usage",id:"e5-disk-xxxxx-on-backend-xxx-exceed-limit-usage",level:3},{value:"E6. invalid cluster id: xxxx",id:"e6-invalid-cluster-id-xxxx",level:3},{value:"E7. Import data by calling stream load through a Java program. When a batch of data is large, a Broken Pipe error may be reported",id:"e7-import-data-by-calling-stream-load-through-a-java-program-when-a-batch-of-data-is-large-a-broken-pipe-error-may-be-reported",level:3},{value:"E8. <code>Lost connection to MySQL server at&#39;reading initial communication packet&#39;, system error: 0</code>",id:"e8-lost-connection-to-mysql-server-atreading-initial-communication-packet-system-error-0",level:3},{value:"E9. -214 error",id:"e9--214-error",level:3},{value:"E10. Not connected to 192.168.100.1:8060 yet, server_id=384",id:"e10-not-connected-to-19216810018060-yet-server_id384",level:3},{value:"E11. <code>recoveryTracker should overlap or follow on disk last VLSN of 4,422,880 recoveryFirst= 4,422,882 UNEXPECTED_STATE_FATAL</code>",id:"e11-recoverytracker-should-overlap-or-follow-on-disk-last-vlsn-of-4422880-recoveryfirst-4422882-unexpected_state_fatal",level:3},{value:"E12.Doris compile and install JDK version incompatibility problem",id:"e12doris-compile-and-install-jdk-version-incompatibility-problem",level:3}],d={toc:c};function h(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,o.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"common-error"},"Common Error"),(0,a.kt)("p",null,"This document is mainly used to record the errors reported during the use of Doris. If you encounter some errors, you are welcome to contribute to us for updates."),(0,a.kt)("h3",{id:"e1-query-error-failed-to-get-scan-range-no-queryable-replica-found-in-tablet-xxxx"},"E1. Query error: Failed to get scan range, no queryable replica found in tablet: xxxx"),(0,a.kt)("p",null,"This situation is because the corresponding tablet does not find a copy that can be queried, usually because the BE is down, the copy is missing, and so on. You can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"show tablet tablet_id")," statement first, and then execute the following ",(0,a.kt)("inlineCode",{parentName:"p"},"show proc")," statement to view the copy information corresponding to this tablet, and check whether the copy is complete. At the same time, you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},'show proc "/cluster_balance"')," information to query the progress of replica scheduling and repair in the cluster."),(0,a.kt)("p",null,"For commands related to data copy management, please refer to ",(0,a.kt)("a",{parentName:"p",href:"/docs/1.0/administrator-guide/operation/tablet-repair-and-balance"},"Data Copy Management"),"."),(0,a.kt)("h3",{id:"e2-fe-failed-to-start-felog-keeps-scrolling-wait-catalog-to-be-ready-fe-type-unknown"},'E2. FE failed to start, fe.log keeps scrolling "wait catalog to be ready. FE type UNKNOWN"'),(0,a.kt)("p",null,"There are usually two reasons for this problem:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The local IP obtained when the FE is started this time is inconsistent with the last time, usually because the ",(0,a.kt)("inlineCode",{parentName:"p"},"priority_network")," is not set correctly, the wrong IP address is matched when the FE is started. Need to modify ",(0,a.kt)("inlineCode",{parentName:"p"},"priority_network")," and restart FE.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Most Follower FE nodes in the cluster are not started. For example, there are 3 Followers and only one is started. At this time, at least one other FE needs to be also activated, and the FE electable group can elect the Master to provide services."))),(0,a.kt)("p",null,"If none of the above conditions can be resolved, you can follow the ","[Metadata Operation and Maintenance Document]"," (../administrator-guide/operation/metadata-operation.md) in the Doris official website to restore."),(0,a.kt)("h3",{id:"e3-tablet-writer-write-failed-tablet_id27306172-txn_id28573520-err-235-or--215-or--238"},"E3. tablet writer write failed, tablet_id=27306172, txn_id=28573520, err=-235 or -215 or -238"),(0,a.kt)("p",null,"This error usually occurs during data import operations. The error code of the new version is -235, and the error code of the old version may be -215. The meaning of this error is that the data version of the corresponding tablet exceeds the maximum limit (default 500, controlled by the BE parameter ",(0,a.kt)("inlineCode",{parentName:"p"},"max_tablet_version_num"),"), and subsequent writes will be rejected. For example, the error in the question means that the data version of the tablet 27306172 exceeds the limit."),(0,a.kt)("p",null,"This error is usually because the import frequency is too high, which is greater than the compaction speed of the background data, which causes the version to accumulate and eventually exceeds the limit. At this point, we can first use the show tablet 27306172 statement, and then execute the show proc statement in the result to view the status of each copy of the tablet. The versionCount in the result represents the number of versions. If you find that there are too many versions of a copy, you need to reduce the import frequency or stop importing, and observe whether the number of versions drops. If the version number still does not decrease after the import is stopped, you need to go to the corresponding BE node to check the be.INFO log, search for the tablet id and compaction keywords, and check whether the compaction is running normally. For compaction tuning related, you can refer to the ApacheDoris public account article: Doris Best Practice-Compaction Tuning (3)"),(0,a.kt)("p",null,"The -238 error usually occurs when the amount of imported data in the same batch is too large, which leads to too many Segment files for a certain tablet (the default is 200, which is controlled by the BE parameter ",(0,a.kt)("inlineCode",{parentName:"p"},"max_segment_num_per_rowset"),"). At this time, it is recommended to reduce the amount of data imported in one batch, or to appropriately increase the value of the BE configuration parameter to solve the problem."),(0,a.kt)("h3",{id:"e4-tablet-110309738-has-few-replicas-1-alive-backends-10003"},"E4. tablet 110309738 has few replicas: 1, alive backends: ","[10003]"),(0,a.kt)("p",null,"This error may occur during query or import operation. It usually means that the copy of the tablet is abnormal."),(0,a.kt)("p",null,"At this point, you can first check whether the BE node is down by using the show backends command, such as the isAlive field is false, or LastStartTime is the most recent time (indicating that it has been restarted recently). If the BE is down, you need to go to the node corresponding to the BE and check the be.out log. If the BE is down due to an exception, usually the exception stack will be printed in be.out to help troubleshoot the problem. If there is no error stack in be.out. You can use the linux command dmesg -T to check whether the process is killed by the system because of OOM."),(0,a.kt)("p",null,"If no BE node is down, you need to use the show tablet 110309738 statement, and then execute the show proc statement in the result to check the status of each copy of the tablet for further investigation."),(0,a.kt)("h3",{id:"e5-disk-xxxxx-on-backend-xxx-exceed-limit-usage"},"E5. disk xxxxx on backend xxx exceed limit usage"),(0,a.kt)("p",null,"It usually appears in operations such as import and Alter. This error means that the usage of the corresponding disk corresponding to the BE exceeds the threshold (95% by default). At this time, you can use the show backends command first, where MaxDiskUsedPct shows the usage of the disk with the highest usage on the corresponding BE. If If it exceeds 95%, this error will be reported."),(0,a.kt)("p",null,"At this time, you need to go to the corresponding BE node to check the usage in the data directory. The trash directory and snapshot directory can be manually cleaned up to free up space. If the data directory occupies a lot, you need to consider deleting some data to free up space. For details, please refer to ",(0,a.kt)("a",{parentName:"p",href:"/docs/1.0/administrator-guide/operation/disk-capacity"},"Disk Space Management"),"."),(0,a.kt)("h3",{id:"e6-invalid-cluster-id-xxxx"},"E6. invalid cluster id: xxxx"),(0,a.kt)("p",null,"This error may appear in the results of the show backends or show frontends commands. It usually appears in the error message column of a certain FE or BE node. The meaning of this error is that after Master FE sends heartbeat information to this node, the node finds that the cluster id carried in the heartbeat information is different from the cluster id stored locally, so it refuses to respond to the heartbeat."),(0,a.kt)("p",null,"Doris' Master FE node will actively send a heartbeat to each FE or BE node, and will carry a cluster_id in the heartbeat information. The cluster_id is the unique cluster ID generated by the Master FE when a cluster is initialized. When the FE or BE receives the heartbeat information for the first time, it will save the cluster_id locally in the form of a file. The FE file is in the image/ directory of the metadata directory, and BE has a cluster_id file in all data directories. After that, every time a node receives a heartbeat, it will compare the content of the local cluster_id with the content in the heartbeat. If it is inconsistent, it will refuse to respond to the heartbeat."),(0,a.kt)("p",null,"This mechanism is a node authentication mechanism to prevent receiving wrong heartbeat information from nodes outside the cluster."),(0,a.kt)("p",null,"If you need to recover from this error. First, confirm whether all nodes are the correct nodes in the cluster. After that, for the FE node, you can try to modify the cluster_id value in the image/VERSION file in the metadata directory and restart the FE. For BE nodes, you can delete cluster_id files in all data directories and restart BE."),(0,a.kt)("h3",{id:"e7-import-data-by-calling-stream-load-through-a-java-program-when-a-batch-of-data-is-large-a-broken-pipe-error-may-be-reported"},"E7. Import data by calling stream load through a Java program. When a batch of data is large, a Broken Pipe error may be reported"),(0,a.kt)("p",null,"In addition to Broken Pipe, there may be other strange errors."),(0,a.kt)("p",null,"This situation usually occurs after opening httpv2. Because httpv2 is an http service implemented using spring boot, and uses tomcat as the default built-in container. But tomcat's handling of 307 forwarding seems to have some problems, so the built-in container will be modified to jetty later. In addition, the version of apache http client in the java program needs to use a version later than 4.5.13. In the previous version, there were also some problems with the processing of forwarding."),(0,a.kt)("p",null,"So this problem can be solved in two ways:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Turn off httpv2"),(0,a.kt)("p",{parentName:"li"},"Add enable_http_server_v2=false in fe.conf and restart FE. However, the new UI interface can no longer be used in this way, and some new interfaces based on httpv2 cannot be used later. (Normal import queries are not affected).")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Upgrade"),(0,a.kt)("p",{parentName:"li"},"You can upgrade to Doris 0.15 and later versions, this problem has been fixed."))),(0,a.kt)("h3",{id:"e8-lost-connection-to-mysql-server-atreading-initial-communication-packet-system-error-0"},"E8. ",(0,a.kt)("inlineCode",{parentName:"h3"},"Lost connection to MySQL server at'reading initial communication packet', system error: 0")),(0,a.kt)("p",null,"If the following problems occur when using the MySQL client to connect to Doris, this is usually caused by the difference between the jdk version used when compiling FE and the jdk version used when running FE.\nNote that when using docker image to compile, the default JDK version is openjdk 11, you can switch to openjdk 8 by command (see the compilation document for details)."),(0,a.kt)("h3",{id:"e9--214-error"},"E9. -214 error"),(0,a.kt)("p",null,"When performing operations such as load and query, you may encounter the following errors:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"failed to initialize storage reader. tablet=63416.1050661139.aa4d304e7a7aff9c-f0fa7579928c85a0, res=-214, backend=192.168.100.10\n")),(0,a.kt)("p",null,"A -214 error means that the data version of the corresponding tablet is missing. For example, the above error indicates that the data version of the replica of tablet 63416 on the BE of 192.168.100.10 is missing. (There may be other similar error codes, which can be checked and repaired in the following ways)."),(0,a.kt)("p",null,"Normally, if your data has multiple replicas, the system will automatically repair these problematic replicas. You can troubleshoot through the following steps:"),(0,a.kt)("p",null,"First, use the ",(0,a.kt)("inlineCode",{parentName:"p"},"show tablet 63416")," statement and execute the ",(0,a.kt)("inlineCode",{parentName:"p"},"show proc xxx")," statement in the result to view the status of each replica of the corresponding tablet. Usually we need to care about the data in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Version")," column."),(0,a.kt)("p",null,"Under normal circumstances, the Version of multiple replicas of a tablet should be the same. And it is the same as the VisibleVersion of the corresponding partition."),(0,a.kt)("p",null,"You can use ",(0,a.kt)("inlineCode",{parentName:"p"},"show partitions from tblx")," to view the corresponding partition version (the partition corresponding to the tablet can be obtained in the ",(0,a.kt)("inlineCode",{parentName:"p"},"show tablet")," statement.)"),(0,a.kt)("p",null,"At the same time, you can also visit the URL in the CompactionStatus column of the ",(0,a.kt)("inlineCode",{parentName:"p"},"show proc")," statement (just open it in the browser) to view more specific version information, to check which version is missing."),(0,a.kt)("p",null,"If there is no automatic repair for a long time, you need to use the ",(0,a.kt)("inlineCode",{parentName:"p"},'show proc "/cluster_balance"')," statement to view the tablet repair and scheduling tasks currently being performed by the system. It may be because there are a large number of tablets waiting to be scheduled, which leads to a long repair time. You can follow the records in ",(0,a.kt)("inlineCode",{parentName:"p"},"pending_tablets")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"running_tablets"),"."),(0,a.kt)("p",null,"Furthermore, you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"admin repair")," statement to specify the priority to repair a table or partition. For details, please refer to ",(0,a.kt)("inlineCode",{parentName:"p"},"help admin repair"),";"),(0,a.kt)("p",null,"If it still cannot be repaired, then in the case of multiple replicas, we use the ",(0,a.kt)("inlineCode",{parentName:"p"},"admin set replica status")," command to force the replica to go offline. For details, please refer to the example of ",(0,a.kt)("inlineCode",{parentName:"p"},"help admin set replica status")," to set the status of the replica to bad. (After set to bad, the replica will not be accessed again. And will be automatically repaired later. But before the operation, you should make sure that the other replicas are normal)"),(0,a.kt)("h3",{id:"e10-not-connected-to-19216810018060-yet-server_id384"},"E10. Not connected to 192.168.100.1:8060 yet, server_id=384"),(0,a.kt)("p",null,"We may encounter this error when loading or querying. If you go to the corresponding BE log to check, you may also find similar errors."),(0,a.kt)("p",null,"This is an RPC error, and there are usually two possibilities: 1. The corresponding BE node is down. 2. rpc congestion or other errors."),(0,a.kt)("p",null,"If the BE node is down, you need to check the specific reason for the downtime. Only the problem of rpc congestion is discussed here."),(0,a.kt)("p",null,"One situation is OVERCROWDED, which means that a large amount of unsent data at the rpc client exceeds the threshold. BE has two parameters related to it:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"brpc_socket_max_unwritten_bytes"),": The default is 1GB. If the unwritten data exceeds this value, an error will be reported. You can modify this value appropriately to avoid OVERCROWDED errors. (But this cures the symptoms rather than the root cause, essentially congestion still occurs)."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"tablet_writer_ignore_eovercrowded"),": The default is false. If set to true, Doris will ignore OVERCROWDED errors during the load process. This parameter is mainly used to avoid load failure and improve the stability of load.")),(0,a.kt)("p",null,"The second is that the packet size of rpc exceeds ",(0,a.kt)("inlineCode",{parentName:"p"},"max_body_size"),". This problem may occur if the query contains a very large String type or a Bitmap type. It can be circumvented by modifying the following BE parameters:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("inlineCode",{parentName:"li"},"brpc_max_body_size"),": The default is 3GB.")),(0,a.kt)("h3",{id:"e11-recoverytracker-should-overlap-or-follow-on-disk-last-vlsn-of-4422880-recoveryfirst-4422882-unexpected_state_fatal"},"E11. ",(0,a.kt)("inlineCode",{parentName:"h3"},"recoveryTracker should overlap or follow on disk last VLSN of 4,422,880 recoveryFirst= 4,422,882 UNEXPECTED_STATE_FATAL")),(0,a.kt)("p",null,"Sometimes when restarting the Fe, the above error will occur (usually only in the case of multiple followers), and the difference between the two values in the error is 2. As a result, the Fe startup fails."),(0,a.kt)("p",null,"This is a bug in bdbje that has not been resolved. In this case, metadata can only be recovered through fault recovery in ",(0,a.kt)("a",{parentName:"p",href:"/docs/1.0/administrator-guide/operation/metadata-operation"},"metadata operation and maintenance manual"),"."),(0,a.kt)("h3",{id:"e12doris-compile-and-install-jdk-version-incompatibility-problem"},"E12.Doris compile and install JDK version incompatibility problem"),(0,a.kt)("p",null,"When I use Docker to compile Doris myself, start FE after compiling and installing, ",(0,a.kt)("inlineCode",{parentName:"p"},"java.lang.Suchmethoderror: java.nio.ByteBuffer.limit (I)Ljava/nio/ByteBuffer; ")," exception information, this is because the default in Docker is JDK 11. If your installation environment is using JDK8, you need to switch the JDK environment to JDK8 in Docker. For the specific switching method, refer to ",(0,a.kt)("a",{parentName:"p",href:"https://doris.apache.org/installing/compilation.html"},"Compilation")))}h.isMDXComponent=!0}}]);